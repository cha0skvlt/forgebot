# LOCK
# üß† Codex Development Workflow (canonical, no CI)

## üìå –¶–µ–ª—å
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É.  
Codex ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫.  
ChatGPT ‚Äî —Å–≤—è–∑—É—é—â–µ–µ –∑–≤–µ–Ω–æ.  
–†—É—á–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–µ—Ç. Git-–ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–µ—Ç. –í—Å—ë —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –¥–æ –ø—É—à–∞.

---

## üõ†Ô∏è –†–æ–ª–∏

- **Architect (user)** ‚Äî —Å—Ç–∞–≤–∏—Ç –∑–∞–¥–∞—á–∏, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è.
- **ChatGPT** ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `codex_task.yml`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–¥–∞—á—É.
- **Codex** ‚Äî –ø–∏—à–µ—Ç –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∫–æ–¥ (pytest, black), –¥–µ–ª–∞–µ—Ç –∫–æ–º–º–∏—Ç –∏ push.

---

## üîÅ –¶–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **–¢—ã:** —Å—Ç–∞–≤–∏—à—å –æ–¥–Ω—É –∑–∞–¥–∞—á—É ‚Üí "–°–¥–µ–ª–∞–π X"
2. **–Ø:** –ø—Ä–µ–≤—Ä–∞—â–∞—é –≤ `codex_task.yml`
3. **Codex:** –¥–µ–ª–∞–µ—Ç PR (`task/<id>`) ‚Üí —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ ‚Üí –ø—É—à–∏—Ç
4. **–¢—ã:** –ø—Ä–æ–≤–µ—Ä—è–µ—à—å, –¥–∞—ë—à—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É

---

## ‚úÖ –£—Å–ª–æ–≤–∏—è —É—Å–ø–µ—Ö–∞

- –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`, –Ω–∏–∫–∞–∫–∏—Ö —Ö–∞—Ä–¥–∫–æ–¥–æ–≤
- –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ = 1 —Ñ–∏—á–∞ –∏–ª–∏ —Ñ–∏–∫—Å
- –ó–∞–¥–∞—á–∏ –¥–ª—è Codex —Ç–æ–ª—å–∫–æ –Ω–∞ ENG
- –¢–µ—Å—Ç—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, –Ω–æ –µ—Å—Ç—å)
- –û–¥–∏–Ω `bot.py` ‚Äî –Ω–∏–∫–∞–∫–∏—Ö –≤—Ç–æ—Ä–∏—á–Ω—ã—Ö entrypoint
- –ù–∏–∫–∞–∫–∏—Ö CI, GitHub Actions, –ª–∏–Ω—Ç–µ—Ä–æ–≤ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –≥–∏—Ç–µ
- –í—Å—ë —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç Codex –¥–æ –∫–æ–º–º–∏—Ç–∞
- ‚ùó –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: **PostgreSQL (—á–µ—Ä–µ–∑ asyncpg)** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –≤–∞—Ä–∏–∞–Ω—Ç

---

# üìÅ –®–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∞ 

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞

üìÅ modbot/
‚îú‚îÄ‚îÄ bot.py                  # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞: aiogram + startup
‚îú‚îÄ‚îÄ .env                    # –∫–æ–Ω—Ñ–∏–≥: TOKEN, OWNER_ID, DATABASE_URL –∏ –ø—Ä
‚îú‚îÄ‚îÄ requirements.txt        # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (aiogram, asyncpg –∏ –ø—Ä)
‚îÇ
‚îú‚îÄ‚îÄ data/                   # —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îú‚îÄ‚îÄ modules/                # üí° —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ admin.py            # –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã: /add_admin, /rm_admin, /list_admin
‚îÇ   ‚îú‚îÄ‚îÄ db.py               # PostgreSQL wrapper –Ω–∞ asyncpg
|   ‚îú‚îÄ‚îÄ menu.py             # –ú–µ–Ω—é –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ reqqr.py            # —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≥–æ—Å—Ç–µ–π, QR, –æ—Ñ–µ—Ä—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ project/                # üß± —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ forge.py            # –ø—Ä–∏–º–µ—Ä: –ª–æ–≥–∏–∫–∞ –ö—É–∑–Ω–∏—Ü—ã, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
‚îÇ‚îÇ
‚îú‚îÄ‚îÄ README.md               # –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ CHANGELOG.md            # –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤—Ä—É—á–Ω—É—é

Dockerfile
Docker-compose.yml 


---

## ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ:
- –Ω–∏–∫–∞–∫–æ–π GitHub Actions / CI
- –Ω–∏–∫–∞–∫–æ–≥–æ black –≤ pre-commit
- –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞ push
- –Ω–∏–∫–∞–∫–æ–≥–æ `__init__.py` –≤–Ω—É—Ç—Ä–∏ `modules/` –∏ `project/`
- –Ω–∏–∫–∞–∫–æ–π –ª–æ–≥–∏–∫–∏ –≤ `bot.py`
- –Ω–∏–∫–∞–∫–æ–π SQLite ‚Äî **—Ç–æ–ª—å–∫–æ PostgreSQL**

## ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
- –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å = `router = Router()`
- –ö–æ–º–∞–Ω–¥—ã ‚Äî `@router.message(Command(...))`
- –í—Å—ë —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `pytest tests/` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º ‚Äî –¥–µ–ª–∞–µ—Ç Codex
- `black .` —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –¥–µ–ª–∞–µ—Ç Codex

---

## ‚úíÔ∏è –°—Ç–∞—Ç—É—Å —à–∞–±–ª–æ–Ω–∞: `—É—Ç–≤–µ—Ä–∂–¥—ë–Ω, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º`
